import type { UserScore } from "@/types/User"
import { ScrollArea } from "@/components/ui/scroll-area"
import { Crown } from "lucide-react"

type LeaderboardProps = {
  user: UserScore[]
  height?: string | number
}

type RankStyle = {
  number: number
  style: string
}

function Leaderboard({ user, height = "100%" }: LeaderboardProps) {
  const rankStyle: RankStyle[] = [
    { number: 1, style: "!text-lightOrange !text-5xl" },
    { number: 2, style: "!text-lightBrown !text-5xl" },
    { number: 3, style: "!text-[#966B6B] !text-5xl" },
  ]

  const getHeightValue = () => {
    if (typeof height === "number") {
      return `${height}px`
    }
    return height
  }

  // Separate 1st place from the rest
  const firstPlace = user.find((u) => u.order === 1)
  const otherPlaces = user.filter((u) => u.order !== 1).sort((a, b) => a.order - b.order)

  const FirstPlaceSection = () => {
    if (!firstPlace) return null

    return (
      <div className="flex flex-col items-center justify-center min-h-90 relative overflow-hidden">

        {/* Crown */}
        <div className="relative mb-1">
          <Crown className="w-13 h-13 text-red fill-red -mb-3" />
        </div>

        {/* Winner podium effect */}
        <div className="bg-gradient-to-t from-yellow-400 to-yellow-300 rounded-full p-1 mb-4">
          <div className="bg-white rounded-full p-4 shadow-inner">
            <div className="w-20 h-20 bg-gradient-to-br from-orange-200 to-orange-300 rounded-full flex items-center justify-center text-4xl font-bold text-orange-800">
              {firstPlace.name.charAt(0).toUpperCase()}
            </div>
          </div>
        </div>

        {/* Winner info */}
        <div className="text-center space-y-2">
          <h2 className="text-2xl font-bold text-gray-800 -mb-2">{firstPlace.name}</h2>
          <a
            href={`/${firstPlace.username}`}
            className="text-lg text-gray-400 cursor-pointer font-medium font-['Baloo_2']"
          >
            @{firstPlace.username}
          </a>

          <div className="flex items-center justify-center gap-2 mt-4">
            <span className="text-2xl font-extrabold text-lightBrown font-['Baloo_2']">{firstPlace.score}</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="17"
              height="29"
              viewBox="0 0 17 29"
              fill="none"
              className="w-4 h-6"
            >
              <g clipPath="url(#clip0_3_33)">
                <path
                  d="M16.6644 13.423H16.5959C16.5949 13.423 16.594 13.423 16.5928 13.423H15.2697C15.0741 13.423 14.9112 13.2807 14.8763 13.0926C14.8763 13.0893 14.8759 13.0861 14.8759 13.0828V9.45575C14.8759 9.26781 14.7257 9.11549 14.5403 9.11549H14.4703C14.4703 9.11549 14.4693 9.11549 14.4687 9.11549H11.0216C10.8253 9.11549 10.6619 8.97202 10.6278 8.78309V6.96172H10.6212V6.68876C10.6254 6.66691 10.6278 6.64447 10.6278 6.62145V5.14821C10.6278 4.96027 10.4775 4.80795 10.2922 4.80795H8.89768C8.70107 4.80795 8.53765 4.66408 8.50388 4.47496V4.47201C8.50388 4.47201 8.50388 4.47102 8.50369 4.47063C8.50369 4.46965 8.50369 4.46866 8.50369 4.46768V2.99444C8.50369 2.8065 8.35347 2.65417 8.16811 2.65417H4.59111C4.59111 2.65417 4.59052 2.65417 4.59033 2.65417H4.24893V4.40195C4.24893 4.42714 4.25126 4.45213 4.25553 4.47594C4.25553 4.47634 4.25553 4.47654 4.25592 4.47693C4.26077 4.66054 4.40886 4.80795 4.59111 4.80795H5.97261C6.19387 4.80795 6.3732 4.98979 6.3732 5.21414V10.8633C6.3732 11.0876 6.19387 11.2695 5.97261 11.2695H4.59111C4.40886 11.2695 4.26058 11.4169 4.25611 11.6005C4.25573 11.6009 4.25573 11.6011 4.25573 11.6015C4.25146 11.6253 4.24913 11.6503 4.24913 11.6754V15.1708C4.24913 15.3953 4.06979 15.5772 3.84834 15.5772H2.46722C2.28498 15.5772 2.1365 15.7244 2.13184 15.9082C2.13145 15.9086 2.13145 15.9092 2.13145 15.9096C2.12718 15.9334 2.12485 15.958 2.12485 15.9834V17.325C2.12485 17.5493 1.94552 17.7312 1.72426 17.7312H0.342368C0.160121 17.7312 0.0116452 17.8784 0.0069871 18.0622C0.00659893 18.0626 0.00659893 18.0632 0.00659893 18.0636C0.00232903 18.0874 0 18.112 0 18.1374V25.9404C0 25.9656 0.00232903 25.9902 0.00659893 26.0142C0.00659893 26.0148 0.00659893 26.0152 0.0069871 26.016C0.0116452 26.1996 0.160121 26.3466 0.342368 26.3466H1.72348C1.94474 26.3466 2.12408 26.5285 2.12408 26.7528V28.0944C2.12408 28.1196 2.12641 28.1442 2.13068 28.1682C2.13068 28.1688 2.13068 28.1692 2.13107 28.17C2.13572 28.3536 2.2842 28.5006 2.46645 28.5006H6.04345C6.2288 28.5006 6.37922 28.3485 6.37922 28.1605V26.6873C6.37922 26.6645 6.37689 26.6422 6.37262 26.6206V26.335H6.37922V24.5255C6.41047 24.3523 6.55021 24.2173 6.72469 24.1962H8.16501C8.35036 24.1962 8.50039 24.0437 8.50039 23.8557V22.3912C8.5262 22.1924 8.69428 22.0393 8.89729 22.0393H10.2204C10.4416 22.0393 10.621 22.2211 10.621 22.4455V26.6558C10.621 26.681 10.6233 26.7056 10.6276 26.7296V28.1684C10.6276 28.1684 10.6276 28.169 10.628 28.1694C10.6322 28.3532 10.7807 28.5008 10.9633 28.5008H12.4159C12.6014 28.5008 12.7516 28.3487 12.7516 28.1607V26.68C12.7856 26.4907 12.9488 26.347 13.1454 26.347H14.5403C14.7257 26.347 14.8757 26.1949 14.8757 26.007V24.5262C14.9095 24.3371 15.0727 24.1935 15.2691 24.1933H16.6642C16.8496 24.1933 16.9998 24.0409 16.9998 23.853V13.7645C16.9998 13.5765 16.8496 13.4242 16.6642 13.4242L16.6644 13.423Z"
                  fill="#EF9E6C"
                />
                <path
                  d="M2.46645 2.65377H4.24836V2.38101C4.25263 2.35916 4.25496 2.33653 4.25496 2.31331V0.840266C4.25496 0.652323 4.10473 0.5 3.91938 0.5H2.46645C2.28421 0.5 2.13631 0.647403 2.13127 0.830819C2.1268 0.855223 2.12408 0.880413 2.12408 0.905997V2.24758C2.12408 2.27336 2.1268 2.29835 2.13127 2.32275C2.13631 2.50637 2.28421 2.65357 2.46645 2.65357V2.65377Z"
                  fill="#EF9E6C"
                />
                <path
                  d="M13.0872 6.96151H14.5402C14.7255 6.96151 14.8757 6.80919 14.8757 6.62124V5.148C14.8757 4.96006 14.7255 4.80774 14.5402 4.80774H13.0872C12.905 4.80774 12.7571 4.95514 12.7521 5.13856C12.7476 5.16296 12.7449 5.18815 12.7449 5.21393V6.55551C12.7449 6.58129 12.7476 6.60648 12.7521 6.63089C12.7571 6.8145 12.905 6.96171 13.0872 6.96171V6.96151Z"
                  fill="#EF9E6C"
                />
                <path
                  d="M2.46645 11.2692H3.91938C4.10473 11.2692 4.25496 11.1169 4.25496 10.929V9.45574C4.25496 9.2678 4.10473 9.11548 3.91938 9.11548H2.46645C2.28421 9.11548 2.13631 9.26288 2.13127 9.4463C2.1268 9.4707 2.12408 9.49589 2.12408 9.52148V10.8631C2.12408 10.8888 2.1268 10.9138 2.13127 10.9382C2.13631 11.1218 2.28421 11.2691 2.46645 11.2691V11.2692Z"
                  fill="#EF9E6C"
                />
              </g>
              <defs>
                <clipPath id="clip0_3_33">
                  <rect width="17" height="28" fill="white" transform="translate(0 0.5)" />
                </clipPath>
              </defs>
            </svg>
          </div>
        </div>
      </div>
    )
  }

  const OtherPlacesSection = () => (
    <div className="w-full h-full">
      <ScrollArea className="w-full]">
        <div className="w-full space-y-2">
          {otherPlaces.map((i, index) => {
            const style: string = rankStyle.find((r) => r.number === i.order)?.style || "!text-3xl"
            const color: string = i.order % 2 == 0 ? "bg-cream" : ""
            return (
              <div
                key={index}
                className={`flex ${color} gap-4 h-[60px] items-center rounded-xl justify-between hover:bg-gray-50 transition-colors`}
              >
                <div className="flex gap-4 px-5 py-2 items-center">
                  <div className="flex w-12 justify-center items-center">
                    <h3 className={style}>{i.order}</h3>
                  </div>
                  <div>
                    <h3 className="font-medium">{i.name}</h3>
                    <a href={`/${i.username}`} className="cursor-pointer text-gray-600 hover:text-gray-800">
                      @{i.username}
                    </a>
                  </div>
                </div>
                <div className="flex gap-3 px-5 py-2 items-center">
                  <h3 className="!text-lightBrown font-bold">{i.score}</h3>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="17"
                    height="29"
                    viewBox="0 0 17 29"
                    fill="none"
                    className="w-4 h-6"
                  >
                    <g clipPath="url(#clip0_3_33)">
                      <path
                        d="M16.6644 13.423H16.5959C16.5949 13.423 16.594 13.423 16.5928 13.423H15.2697C15.0741 13.423 14.9112 13.2807 14.8763 13.0926C14.8763 13.0893 14.8759 13.0861 14.8759 13.0828V9.45575C14.8759 9.26781 14.7257 9.11549 14.5403 9.11549H14.4703C14.4703 9.11549 14.4693 9.11549 14.4687 9.11549H11.0216C10.8253 9.11549 10.6619 8.97202 10.6278 8.78309V6.96172H10.6212V6.68876C10.6254 6.66691 10.6278 6.64447 10.6278 6.62145V5.14821C10.6278 4.96027 10.4775 4.80795 10.2922 4.80795H8.89768C8.70107 4.80795 8.53765 4.66408 8.50388 4.47496V4.47201C8.50388 4.47201 8.50388 4.47102 8.50369 4.47063C8.50369 4.46965 8.50369 4.46866 8.50369 4.46768V2.99444C8.50369 2.8065 8.35347 2.65417 8.16811 2.65417H4.59111C4.59111 2.65417 4.59052 2.65417 4.59033 2.65417H4.24893V4.40195C4.24893 4.42714 4.25126 4.45213 4.25553 4.47594C4.25553 4.47634 4.25553 4.47654 4.25592 4.47693C4.26077 4.66054 4.40886 4.80795 4.59111 4.80795H5.97261C6.19387 4.80795 6.3732 4.98979 6.3732 5.21414V10.8633C6.3732 11.0876 6.19387 11.2695 5.97261 11.2695H4.59111C4.40886 11.2695 4.26058 11.4169 4.25611 11.6005C4.25573 11.6009 4.25573 11.6011 4.25573 11.6015C4.25146 11.6253 4.24913 11.6503 4.24913 11.6754V15.1708C4.24913 15.3953 4.06979 15.5772 3.84834 15.5772H2.46722C2.28498 15.5772 2.1365 15.7244 2.13184 15.9082C2.13145 15.9086 2.13145 15.9092 2.13145 15.9096C2.12718 15.9334 2.12485 15.958 2.12485 15.9834V17.325C2.12485 17.5493 1.94552 17.7312 1.72426 17.7312H0.342368C0.160121 17.7312 0.0116452 17.8784 0.0069871 18.0622C0.00659893 18.0626 0.00659893 18.0632 0.00659893 18.0636C0.00232903 18.0874 0 18.112 0 18.1374V25.9404C0 25.9656 0.00232903 25.9902 0.00659893 26.0142C0.00659893 26.0148 0.00659893 26.0152 0.0069871 26.016C0.0116452 26.1996 0.160121 26.3466 0.342368 26.3466H1.72348C1.94474 26.3466 2.12408 26.5285 2.12408 26.7528V28.0944C2.12408 28.1196 2.12641 28.1442 2.13068 28.1682C2.13068 28.1688 2.13068 28.1692 2.13107 28.17C2.13572 28.3536 2.2842 28.5006 2.46645 28.5006H6.04345C6.2288 28.5006 6.37922 28.3485 6.37922 28.1605V26.6873C6.37922 26.6645 6.37689 26.6422 6.37262 26.6206V26.335H6.37922V24.5255C6.41047 24.3523 6.55021 24.2173 6.72469 24.1962H8.16501C8.35036 24.1962 8.50039 24.0437 8.50039 23.8557V22.3912C8.5262 22.1924 8.69428 22.0393 8.89729 22.0393H10.2204C10.4416 22.0393 10.621 22.2211 10.621 22.4455V26.6558C10.621 26.681 10.6233 26.7056 10.6276 26.7296V28.1684C10.6276 28.1684 10.6276 28.169 10.628 28.1694C10.6322 28.3532 10.7807 28.5008 10.9633 28.5008H12.4159C12.6014 28.5008 12.7516 28.3487 12.7516 28.1607V26.68C12.7856 26.4907 12.9488 26.347 13.1454 26.347H14.5403C14.7257 26.347 14.8757 26.1949 14.8757 26.007V24.5262C14.9095 24.3371 15.0727 24.1935 15.2691 24.1933H16.6642C16.8496 24.1933 16.9998 24.0409 16.9998 23.853V13.7645C16.9998 13.5765 16.8496 13.4242 16.6642 13.4242L16.6644 13.423Z"
                        fill="#EF9E6C"
                      />
                      <path
                        d="M2.46645 2.65377H4.24836V2.38101C4.25263 2.35916 4.25496 2.33653 4.25496 2.31331V0.840266C4.25496 0.652323 4.10473 0.5 3.91938 0.5H2.46645C2.28421 0.5 2.13631 0.647403 2.13127 0.830819C2.1268 0.855223 2.12408 0.880413 2.12408 0.905997V2.24758C2.12408 2.27336 2.1268 2.29835 2.13127 2.32275C2.13631 2.50637 2.28421 2.65357 2.46645 2.65357V2.65377Z"
                        fill="#EF9E6C"
                      />
                      <path
                        d="M13.0872 6.96151H14.5402C14.7255 6.96151 14.8757 6.80919 14.8757 6.62124V5.148C14.8757 4.96006 14.7255 4.80774 14.5402 4.80774H13.0872C12.905 4.80774 12.7571 4.95514 12.7521 5.13856C12.7476 5.16296 12.7449 5.18815 12.7449 5.21393V6.55551C12.7449 6.58129 12.7476 6.60648 12.7521 6.63089C12.7571 6.8145 12.905 6.96171 13.0872 6.96171V6.96151Z"
                        fill="#EF9E6C"
                      />
                      <path
                        d="M2.46645 11.2692H3.91938C4.10473 11.2692 4.25496 11.1169 4.25496 10.929V9.45574C4.25496 9.2678 4.10473 9.11548 3.91938 9.11548H2.46645C2.28421 9.11548 2.13631 9.26288 2.13127 9.4463C2.1268 9.4707 2.12408 9.49589 2.12408 9.52148V10.8631C2.12408 10.8888 2.1268 10.9138 2.13127 10.9382C2.13631 11.1218 2.28421 11.2691 2.46645 11.2691V11.2692Z"
                        fill="#EF9E6C"
                      />
                    </g>
                    <defs>
                      <clipPath id="clip0_3_33">
                        <rect width="17" height="28" fill="white" transform="translate(0 0.5)" />
                      </clipPath>
                    </defs>
                  </svg>
                </div>
              </div>
            )
          })}
        </div>
      </ScrollArea>
    </div>
  )

  return (
    <div className="w-full flex gap-6" style={{ height: getHeightValue() }}>
      {/* Left Section - 1st Place Winner */}
      <div className="w-2/5 h-full">
        <FirstPlaceSection />
      </div>

      {/* Right Section - Other Places */}
      <div className="w-3/5 h-full">
        <OtherPlacesSection />
      </div>
    </div>
  )
}

export default Leaderboard
